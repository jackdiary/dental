# CORS 설정 수정 구현 계획

- [x] 1. CORS 설정 유틸리티 모듈 생성






  - config/cors_settings.py 파일 생성하여 환경별 CORS 설정 관리 클래스 구현
  - 환경 감지 및 설정 검증 로직 구현
  - _요구사항: 1.4, 2.1, 2.2_



- [ ] 2. 프로덕션 설정 파일 수정
  - [ ] 2.1 production.py의 CORS 설정 충돌 해결
    - CORS_ALLOW_ALL_ORIGINS = True 제거




    - 올바른 프론트엔드 도메인으로 CORS_ALLOWED_ORIGINS 설정
    - _요구사항: 1.1, 1.4_

  - [ ] 2.2 환경 변수 기반 CORS 설정 구현
    - 환경 변수에서 허용된 오리진 로드하는 로직 개선
    - 프로덕션 환경에 맞는 보안 설정 적용
    - _요구사항: 2.1, 2.4_

- [x] 3. 개발 환경 설정 개선

  - [x] 3.1 development.py CORS 설정 추가


    - localhost 및 개발 서버 오리진 허용
    - 개발 환경에 적합한 CORS 정책 설정
    - _요구사항: 1.5, 2.2_


- [ ] 4. CORS 디버깅 및 모니터링 기능 구현
  - [x] 4.1 CORS 헬스 체크 엔드포인트 생성


    - apps/api/views.py에 CORSHealthCheckView 추가
    - 현재 CORS 설정 상태를 반환하는 API 구현
    - _요구사항: 3.4_

  - [x] 4.2 CORS 로깅 시스템 구현


    - CORS 요청 성공/실패 로깅 추가
    - 설정 로드 시 CORS 구성 정보 로깅
    - _요구사항: 2.3, 3.2, 3.3_


- [ ] 5. 미들웨어 순서 및 설정 검증
  - [x] 5.1 base.py 미들웨어 순서 확인 및 수정

    - corsheaders.middleware.CorsMiddleware가 최상단에 위치하는지 확인
    - 필요시 미들웨어 순서 조정
    - _요구사항: 1.2_

  - [x] 5.2 CORS 설정 검증 함수 구현


    - 애플리케이션 시작 시 CORS 설정 유효성 검사
    - 잘못된 설정 감지 및 경고 로그 출력


    - _요구사항: 3.3_

- [ ] 6. 환경 변수 템플릿 업데이트
  - [x] 6.1 .env.production.template 파일 수정


    - CORS 관련 환경 변수 예시 추가
    - 프로덕션 배포 가이드에 CORS 설정 방법 추가
    - _요구사항: 2.1_

- [ ] 7. URL 설정 업데이트
  - [ ] 7.1 CORS 헬스 체크 엔드포인트 URL 추가



    - apps/api/urls.py에 헬스 체크 URL 패턴 추가
    - 루트 URL 설정에 헬스 체크 경로 포함
    - _요구사항: 3.4_

- [ ]* 8. 테스트 코드 작성
  - [ ]* 8.1 CORS 설정 단위 테스트
    - 환경별 설정 로드 테스트
    - 설정 검증 함수 테스트
    - _요구사항: 2.2, 3.3_

  - [ ]* 8.2 CORS 통합 테스트
    - 실제 CORS 요청/응답 테스트
    - 프리플라이트 요청 처리 테스트
    - _요구사항: 1.1, 1.2_

- [ ] 9. 배포 및 검증
  - [ ] 9.1 프로덕션 환경 변수 설정
    - Google Cloud Run에 CORS_ALLOWED_ORIGINS 환경 변수 추가
    - 프론트엔드 도메인을 환경 변수로 설정
    - _요구사항: 2.1_

  - [ ] 9.2 배포 후 CORS 동작 확인
    - 브라우저 개발자 도구에서 CORS 헤더 확인
    - 프론트엔드-백엔드 API 통신 테스트
    - _요구사항: 1.1, 1.3_