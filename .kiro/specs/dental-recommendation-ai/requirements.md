# 요구사항 문서

## 개요

치과 추천 AI 시스템은 사용자가 거주 지역만 입력하면 리뷰 분석을 기반으로 가격이 합리적이고 과잉진료 없는 치과를 추천하는 Django 기반 웹 애플리케이션입니다. 이 시스템은 머신러닝을 활용한 감성 분석, 가격 추출, 그리고 종합적인 추천 알고리즘을 통해 사용자에게 신뢰할 수 있는 치과 정보를 제공합니다.

## 용어 정의

- **치과추천시스템**: 치과 추천 AI 시스템의 전체 Django 애플리케이션
- **리뷰크롤러**: 네이버 플레이스와 구글 맵에서 치과 리뷰를 수집하는 Celery 비동기 태스크
- **감성분석엔진**: Aspect-Based Sentiment Analysis 엔진으로 리뷰를 6가지 측면에서 분석하는 ML 모듈
- **가격추출기**: 리뷰에서 가격 정보를 추출하는 NER 모듈
- **추천알고리즘**: 종합 점수를 계산하여 치과를 추천하는 알고리즘
- **API게이트웨이**: Django REST Framework 기반의 API 엔드포인트 집합
- **사용자**: 치과 추천을 요청하는 일반 사용자
- **관리자**: 시스템 관리 권한을 가진 사용자
- **지역**: 사용자가 입력하는 지역 정보 (예: 강남구)
- **분석측면**: 리뷰 분석의 6가지 측면 (가격, 의료진 실력, 친절도, 대기시간, 시설, 과잉진료)

## 요구사항

### 요구사항 1

**사용자 스토리:** 사용자로서, 지역명만 입력해서 치과 추천을 받고 싶다. 그래야 내 지역에서 과잉진료 없고 합리적인 가격의 치과를 찾을 수 있다.

#### 수락 기준

1. 사용자가 지역명을 입력하면, 치과추천시스템은 반경 5km 내 상위 10개 추천 치과 목록을 반환해야 한다
2. 치과추천시스템은 가격합리성(30%), 의료진실력(25%), 과잉진료위험도(25%), 환자만족도(20%) 기반으로 종합점수를 계산해야 한다
3. 치과추천시스템은 최소 10개 이상의 리뷰가 있는 치과만 추천 결과에 포함해야 한다
4. 사용자가 치료 종류를 선택적 필터로 지정하는 경우, 치과추천시스템은 해당 치료의 가격 데이터가 있는 치과를 우선해야 한다
5. 치과추천시스템은 각 추천에 대해 구체적인 이유와 함께 설명을 제공해야 한다

### 요구사항 2

**사용자 스토리:** 사용자로서, 추천받은 치과의 상세 정보를 보고 싶다. 그래야 치과 진료에 대해 정보에 기반한 결정을 내릴 수 있다.

#### 수락 기준

1. 사용자가 치과 상세 정보를 요청하면, 치과추천시스템은 6개 카테고리 모두에 대한 측면별 감성 점수를 표시해야 한다
2. 치과추천시스템은 일반적인 치료에 대한 가격 분포 데이터를 지역 평균과 비교하여 보여줘야 한다
3. 치과추천시스템은 과잉진료 위험 점수를 0-100 척도로 표시해야 한다
4. 치과추천시스템은 감성 하이라이트와 함께 익명화된 리뷰 요약을 제공해야 한다
5. 치과추천시스템은 주차 가능 여부와 야간 진료 시간을 포함한 시설 정보를 제공해야 한다

### 요구사항 3

**사용자 스토리:** 관리자로서, 리뷰 데이터 수집과 처리를 관리하고 싶다. 그래야 시스템이 최신이고 정확한 정보를 유지할 수 있다.

#### 수락 기준

1. 관리자가 리뷰 크롤링을 실행하면, 리뷰크롤러는 Selenium 또는 API를 사용하여 네이버 플레이스와 구글 맵에서 리뷰를 수집해야 한다
2. 리뷰크롤러는 리뷰어 이름과 민감한 데이터를 마스킹하여 개인정보를 익명화해야 한다
3. 리뷰크롤러는 중복 리뷰를 제거하고 자동으로 데이터 정제를 수행해야 한다
4. 리뷰크롤러는 KoNLPy를 사용하여 한국어 형태소 분석을 통해 리뷰를 처리해야 한다
5. 크롤링이 진행되는 동안, 치과추천시스템은 Celery 태스크 모니터링을 통해 크롤링 상태를 업데이트해야 한다

### 요구사항 4

**사용자 스토리:** 시스템으로서, 리뷰에 대한 정확한 감성 분석을 수행하고 싶다. 그래야 환자 경험을 기반으로 신뢰할 수 있는 추천을 제공할 수 있다.

#### 수락 기준

1. 감성분석엔진은 각 리뷰를 6가지 특정 측면에서 분석해야 한다: 가격, 의료진 실력, 친절도, 대기시간, 시설, 과잉진료
2. 감성분석엔진은 각 측면에 대해 -1(매우 부정적)부터 +1(매우 긍정적)까지의 감성 점수를 할당해야 한다
3. KoBERT 모델이 사용 가능한 경우, 감성분석엔진은 향상된 정확도를 위해 파인튜닝된 KoBERT를 사용해야 한다
4. KoBERT를 사용할 수 없는 경우, 감성분석엔진은 TF-IDF와 함께 scikit-learn SVM을 대체 방법으로 사용해야 한다
5. 감성분석엔진은 한국어 텍스트에 최적화된 전문 검색과 함께 PostgreSQL에 측면 점수를 저장해야 한다

### 요구사항 5

**사용자 스토리:** 시스템으로서, 리뷰에서 가격 정보를 추출하고 분석하고 싶다. 그래야 정확한 가격 비교를 제공하고 과도한 가격책정을 감지할 수 있다.

#### 수락 기준

1. 가격추출기는 정규표현식과 NER 모델을 사용하여 치료별 가격을 식별해야 한다
2. 가격추출기는 스케일링, 임플란트, 신경치료, 교정을 포함한 일반적인 치료의 가격을 추출해야 한다
3. 가격추출기는 각 치료 유형에 대한 지역별 평균 가격을 자동으로 계산해야 한다
4. 가격추출기는 리뷰에서 새로운 가격 정보가 감지되면 가격 데이터베이스를 업데이트해야 한다
5. 가격추출기는 치과 가격이 지역 평균보다 30% 이상 초과할 때 잠재적 과도한 가격책정을 표시해야 한다

### 요구사항 6

**사용자 스토리:** 사용자로서, REST API를 통해 추천 시스템에 접근하고 싶다. 그래야 웹이나 모바일 애플리케이션과 통합할 수 있다.

#### 수락 기준

1. API게이트웨이는 지역과 선택적 치료 유형 매개변수를 받는 POST /api/recommend/ 엔드포인트를 제공해야 한다
2. API게이트웨이는 3초 이내에 치과 목록, 점수, 추천 설명이 포함된 JSON 응답을 반환해야 한다
3. API게이트웨이는 사용자 관리를 위해 djangorestframework-simplejwt를 사용한 JWT 인증을 구현해야 한다
4. API게이트웨이는 페이지당 최대 20개 결과로 치과 목록에 대한 페이지네이션을 제공해야 한다
5. API게이트웨이는 인증된 사용자당 시간당 100개 요청의 속도 제한을 포함해야 한다

### 요구사항 7

**사용자 스토리:** 사용자로서, 내 지역의 여러 치과 간 치료 가격을 비교하고 싶다. 그래야 가장 비용 효과적인 옵션을 찾을 수 있다.

#### 수락 기준

1. 사용자가 가격 비교를 요청하면, 치과추천시스템은 지정된 치료에 대한 가격 분포 차트를 표시해야 한다
2. 치과추천시스템은 지정된 지역 내에서 최소, 최대, 평균 가격을 보여줘야 한다
3. 치과추천시스템은 지역 평균보다 낮은 가격을 제공하는 치과를 강조해야 한다
4. 치과추천시스템은 수집된 가격 데이터 포인트 수를 기반으로 가격 신뢰도를 표시해야 한다

### 요구사항 8

**사용자 스토리:** 관리자로서, 시스템 성능을 모니터링하고 데이터 품질을 관리하고 싶다. 그래야 추천 시스템이 효과적으로 작동하는지 확인할 수 있다.

#### 수락 기준

1. 치과추천시스템은 리뷰 관리를 위한 사용자 정의 대시보드가 있는 Django Admin 인터페이스를 제공해야 한다
2. 치과추천시스템은 정확도와 F1 점수를 포함한 ML 모델 성능 지표를 표시해야 한다
3. 치과추천시스템은 관리자 인터페이스를 통해 수동 리뷰 플래깅과 품질 관리를 허용해야 한다
4. 치과추천시스템은 데이터 신선도와 크롤링 성공률에 대한 자동화된 보고서를 생성해야 한다
5. 치과추천시스템은 Redis와 Celery 상태 지표와 함께 시스템 상태 모니터링을 제공해야 한다